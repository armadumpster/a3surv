{
	private _fnc_scriptNameParent = if (isNil '_fnc_scriptName') then {'A3SClient_fnc_repairVehicle'} else {_fnc_scriptName};
	private _fnc_scriptName = 'A3SClient_fnc_repairVehicle';
	scriptName _fnc_scriptName;

#line 1 "A3S_client\bin\scripts\interaction\vinteraction\fn_repairVehicle.sqf [A3SClient_fnc_repairVehicle]"

scriptName"fn_repairVehicle";_ID=param[0,-1,[0]];if(!a3s_Alive) exitWith{};if(a3s_inAction) exitWith{};_unit=player;_vehicle=a3s_cursorTarget;if(_unit distance _vehicle>6) exitWith{};_items_unit=(vestItems _unit)+(backpackITems _unit)+(uniformItems _unit);if(_ID>-1) then{if!("A3S_Item_Toolbox"in(vestItems _unit)+(backpackITems _unit)+(uniformItems _unit)) exitWith{["<t color='#AB0E00'>I don't have a tool box</t>"]call A3SClient_fnc_addToFeed;};_hitPoints=[];{if((_x select 0) isEqualTo(typeOf _vehicle)) then{_hitPoints=(_x select 1);};}forEach a3s_sv_vehicleHitPoints;if(count _hitPoints isEqualTo 0) then{_hitPoints=a3s_sv_vehicleHitPointsDefault;};_toRepair=_hitPoints select _ID;_needItem=switch(_toRepair) do{case"HitLFWheel":{"A3S_Item_Wheel"};case"HitLF2Wheel":{"A3S_Item_Wheel"};case"HitRFWheel":{"A3S_Item_Wheel"};case"HitRF2Wheel":{"A3S_Item_Wheel"};case"HitFuel":{"A3S_Item_Fueltank"};case"HitEngine":{"A3S_Item_Engine"};case"HitAvionics":{"A3S_Item_Scrapmetal"};case"HitHRotor":{"A3S_Item_Rotor"};case"HitVRotor":{"A3S_Item_Rotor"};case"HitHull":{"A3S_Item_Scrapmetal"};case"HitBody":{"A3S_Item_Scrapmetal"};case"HitLMWheel":{"A3S_Item_Wheel"};case"HitRMWheel":{"A3S_Item_Wheel"};};if!(_needItem in _items_unit) exitWith{["<t color='#AB0E00'>I don't have the required part...</t>"]call A3SClient_fnc_addToFeed;};a3s_inAction=true;if(currentWeapon _unit!="") then{["<t color='#ffff00'>I will put my weapon back</t>"]call A3SClient_fnc_addToFeed;_unit action["switchWeapon",_unit,_unit,100];uisleep 3;};[_unit,"a3s_repair_01"]remoteExecCall["say3D",-2];_progress=0.01;_exitWith=false;for"_i"from 0 to 1 step 0 do{if(animationState _unit!="AinvPknlMstpSnonWnonDnon_medic_1") then{_unit playMoveNow"AinvPknlMstpSnonWnonDnon_medic_1";};uisleep 1.4;_progress=_progress+0.1;if(!a3s_Alive) exitWith{_exitWith=true;
};if(_unit!=vehicle _unit) exitWith{_exitWith=true;};if(_unit distance _vehicle>6) exitWith{_exitWith=true;};if(_progress>=1) exitWith{};};a3s_inAction=false;_unit playActionNow"stop";if(_exitWith) exitWith{};_unit removeItem _needItem;["<t color='#A3FB26'>That part should be good now</t>"]call A3SClient_fnc_addToFeed;_vehicle setHitPointDamage[_toRepair,0];[[_vehicle,_toRepair],{(_this select 0) setHitPointDamage[_this select 1,0];}]remoteExecCall["BIS_FNC_SPAWN"];if(_needItem in["HitHull","HitBody"]) then{[]spawn{uisleep 4.5;{_vehicle setHitPointDamage[_x,0];}forEach[""];};};}else{if("A3S_Item_Jerrycan"in _items_unit) then{_fuelCapacity=getNumber(configfile>>"CfgVehicles">>(typeOf _vehicle)>>"fuelCapacity");_jerryCanCapacity=10;_upper=(_jerryCanCapacity/_fuelCapacity);a3s_inAction=true;if(currentWeapon _unit!="") then{["<t color='#ffff00'>I will put my weapon back</t>"]call A3SClient_fnc_addToFeed;_unit action["switchWeapon",_unit,_unit,100];uisleep 3;};[_unit,"a3s_refuel_01"]remoteExecCall["say3D",-2];_progress=0.01;_exitWith=false;for"_i"from 0 to 1 step 0 do{if(animationState _unit!="AinvPknlMstpSnonWnonDnon_medic_1") then{_unit playMoveNow"AinvPknlMstpSnonWnonDnon_medic_1";};uisleep 1.4;_progress=_progress+0.1;if(!a3s_Alive) exitWith{_exitWith=true;};if(_unit!=vehicle _unit) exitWith{_exitWith=true;};if(_unit distance _vehicle>6) exitWith{_exitWith=true;};if(_progress>=1) exitWith{};};a3s_inAction=false;_unit playActionNow"stop";if(_exitWith) exitWith{};_amount=((fuel _vehicle)+_upper);if(isNull _vehicle) then{}else{_unit removeItem"A3S_Item_Jerrycan";_unit addItem"A3S_Item_Jerrycan_Empty";};if(local _vehicle) then{_vehicle setFuel _amount;}else{[_vehicle,_amount]remoteExecCall["setFuel",_vehicle];};[format["<t color='#A3FB26'>I have refilled the vehicle with 10 liters of fuel (%1)</t>",(_this select 0)]]call A3SClient_fnc_addToFeed;}else{["<t color='#A3FB26'>I don't have a Jerry Can with me</t>"]call A3SClient_fnc_addToFeed;};};
}